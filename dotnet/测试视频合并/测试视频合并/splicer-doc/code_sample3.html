<html>
<body>
<!--
{\rtf1\ansi\ansicpg\lang1024\noproof1252\uc1 \deff0{\fonttbl{\f0\fnil\fcharset0\fprq1 ProggyCleanTT;}}{\colortbl;\red0\green0\blue0;\red0\green0\blue255;\red0\green255\blue255;\red0\green255\blue0??;\red255\green0\blue255;\red255\green0\blue0;\red255\green255\blue0;\red255\green255\blue255;??\red0\green0\blue128;\red0\green128\blue128;\red0\green128\blue0;??\red128\green0\blue128;\red128\green0\blue0;\red128\green128\blue0;\red128\green128\blue128;??\red192\green192\blue192;}??\fs24 \cf2 string\cf0  outputFile = \cf13 "PixelateAndIrisBetweenImages.wmv"\cf0 ;\par ??\par ??            \cf2 using\cf0  (\cf10 ITimeline\cf0  timeline = \cf2 new\cf0  \cf10 DefaultTimeline\cf0 ())\par ??            \{\par ??                timeline.AddAudioGroup().AddTrack().AddClip(\cf13 "testinput.wav"\cf0 , \cf10 GroupMediaType\cf0 .Audio,\par ??                                                            \cf10 InsertPosition\cf0 .Relative, 0, 0, 17);\par ??\par ??                \cf10 IGroup\cf0  group = timeline.AddVideoGroup(32, 160, 100);\par ??                \cf10 ITrack\cf0  low = group.AddTrack();\par ??                \cf10 ITrack\cf0  hi = group.AddTrack();\par ??                hi.AddClip(\cf13 "image1.jpg"\cf0 , \cf10 GroupMediaType\cf0 .Image, \cf10 InsertPosition\cf0 .Absoloute, 0, 0, 6);\par ??                low.AddClip(\cf13 "image2.jpg"\cf0 , \cf10 GroupMediaType\cf0 .Image, \cf10 InsertPosition\cf0 .Absoloute, 5, 0, 8);\par ??                hi.AddClip(\cf13 "image3.jpg"\cf0 , \cf10 GroupMediaType\cf0 .Image, \cf10 InsertPosition\cf0 .Absoloute, 11, 0, 6);\par ??\par ??                \cf11 // notice that we must apply "in" and "out" of the pixelation effect, to get the\par ??\cf0                 \cf11 // desired effect, like the fade\par ??\cf0                 hi.AddTransition(5.0, 1.0, \cf10 StandardTransitions\cf0 .CreatePixelate(), \cf2 true\cf0 );\par ??                hi.AddTransition(6.0, 1.0, \cf10 StandardTransitions\cf0 .CreatePixelate(), \cf2 false\cf0 );\par ??\par ??                \cf11 // the iris transition is a one shot\par ??\cf0                 hi.AddTransition(11.0, 2.0, \cf10 StandardTransitions\cf0 .CreateIris(), \cf2 false\cf0 );\par ??\par ??                \cf2 using\cf0  (\par ??                    \cf10 IRenderer\cf0  renderer =\par ??                        \cf2 new\cf0  \cf10 WindowsMediaRenderer\cf0 (timeline, outputFile, \cf10 WindowsMediaProfiles\cf0 .HighQualityVideo))\par ??                \{\par ??                    renderer.Render();\par ??                \}\par ??            \}}
-->
<div style="font-family: Courier; font-size: 10pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue;">string</span> outputFile = <span style="color: maroon;">"PixelateAndIrisBetweenImages.wmv"</span>;</p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"> <span style="color: blue;">using</span> (<span style="color: teal;">ITimeline</span> timeline = <span style="color: blue;">new</span> <span style="color: teal;">DefaultTimeline</span>())</p>
<p style="margin: 0px;"> {</p>
<p style="margin: 0px;"> &nbsp;&nbsp;&nbsp; timeline.AddAudioGroup().AddTrack().AddClip(<span style="color: maroon;">"testinput.wav"</span>, <span style="color: teal;">GroupMediaType</span>.Audio,</p>
<p style="margin: 0px;">     <span style="color: teal;">InsertPosition</span>.Relative, 0, 0, 17);</p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"> &nbsp;&nbsp;&nbsp; <span style="color: teal;">IGroup</span> group = timeline.AddVideoGroup(32, 160, 100);</p>
<p style="margin: 0px;"> &nbsp;&nbsp;&nbsp; <span style="color: teal;">ITrack</span> low = group.AddTrack();</p>
<p style="margin: 0px;"> &nbsp;&nbsp;&nbsp; <span style="color: teal;">ITrack</span> hi = group.AddTrack();</p>
<p style="margin: 0px;"> &nbsp;&nbsp;&nbsp; hi.AddClip(<span style="color: maroon;">"image1.jpg"</span>, <span style="color: teal;">GroupMediaType</span>.Image, <span style="color: teal;">InsertPosition</span>.Absoloute, 0, 0, 6);</p>
<p style="margin: 0px;"> &nbsp;&nbsp;&nbsp; low.AddClip(<span style="color: maroon;">"image2.jpg"</span>, <span style="color: teal;">GroupMediaType</span>.Image, <span style="color: teal;">InsertPosition</span>.Absoloute, 5, 0, 8);</p>
<p style="margin: 0px;"> &nbsp;&nbsp;&nbsp; hi.AddClip(<span style="color: maroon;">"image3.jpg"</span>, <span style="color: teal;">GroupMediaType</span>.Image, <span style="color: teal;">InsertPosition</span>.Absoloute, 11, 0, 6);</p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"> &nbsp;&nbsp;&nbsp; <span style="color: green;">// notice that we must apply "in" and "out" of the pixelation effect, to get the</span></p>
<p style="margin: 0px;"> &nbsp;&nbsp;&nbsp; <span style="color: green;">// desired effect, like the fade</span></p>
<p style="margin: 0px;"> &nbsp;&nbsp;&nbsp; hi.AddTransition(5.0, 1.0, <span style="color: teal;">StandardTransitions</span>.CreatePixelate(), <span style="color: blue;">true</span>);</p>
<p style="margin: 0px;"> &nbsp;&nbsp;&nbsp; hi.AddTransition(6.0, 1.0, <span style="color: teal;">StandardTransitions</span>.CreatePixelate(), <span style="color: blue;">false</span>);</p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"> &nbsp;&nbsp;&nbsp; <span style="color: green;">// the iris transition is a one shot</span></p>
<p style="margin: 0px;"> &nbsp;&nbsp;&nbsp; hi.AddTransition(11.0, 2.0, <span style="color: teal;">StandardTransitions</span>.CreateIris(), <span style="color: blue;">false</span>);</p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"> &nbsp;&nbsp;&nbsp; <span style="color: blue;">using</span> (</p>
<p style="margin: 0px;"> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal;">IRenderer</span> renderer =  <span style="color: blue;">new</span> <span style="color: teal;">WindowsMediaRenderer</span>(timeline, outputFile, <span style="color: teal;">WindowsMediaProfiles</span>.HighQualityVideo))</p>
<p style="margin: 0px;"> &nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px;"> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; renderer.Render();</p>
<p style="margin: 0px;"> &nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px;"> }</p>
</div>

</body>
</html>