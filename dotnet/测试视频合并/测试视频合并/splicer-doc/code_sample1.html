<html>
<body>
<!--
{\rtf1\ansi\ansicpg\lang1024\noproof1252\uc1 \deff0{\fonttbl{\f0\fnil\fcharset0\fprq1 ProggyCleanTT;}}{\colortbl;\red0\green0\blue0;\red0\green0\blue255;\red0\green255\blue255;\red0\green255\blue0??;\red255\green0\blue255;\red255\green0\blue0;\red255\green255\blue0;\red255\green255\blue255;??\red0\green0\blue128;\red0\green128\blue128;\red0\green128\blue0;??\red128\green0\blue128;\red128\green0\blue0;\red128\green128\blue0;\red128\green128\blue128;??\red192\green192\blue192;}??\fs24             \cf11 // generates a little slide-show, with audio track and fades between images.\par ??\par ??\cf0             \cf2 string\cf0  outputFile = \cf13 "FadeBetweenImages.wmv"\cf0 ;\par ??\par ??            \cf2 using\cf0  (\cf10 ITimeline\cf0  timeline = \cf2 new\cf0  \cf10 DefaultTimeline\cf0 ())\par ??            \{\par ??                \cf10 IGroup\cf0  group = timeline.AddVideoGroup(32, 160, 100);\par ??                \par ??                \cf10 ITrack\cf0  videoTrack = group.AddTrack();\par ??                \cf10 IClip\cf0  clip1 = videoTrack.AddImage(\cf13 "image1.jpg"\cf0 , 0, 2); \cf11 // play first image for a little while\par ??\cf0                 \cf10 IClip\cf0  clip2 = videoTrack.AddImage(\cf13 "image2.jpg"\cf0 , 0, 2); \cf11 // and the next\par ??\cf0                 \cf10 IClip\cf0  clip3 = videoTrack.AddImage(\cf13 "image3.jpg"\cf0 , 0, 2); \cf11 // and finally the last\par ??\cf0                 \cf10 IClip\cf0  clip4 = videoTrack.AddImage(\cf13 "image4.jpg"\cf0 , 0, 2); \cf11 // and finally the last\par ??\par ??\cf0                 \cf2 double\cf0  halfDuration = 0.5;\par ??\par ??                \cf11 // fade out and back in\par ??\cf0                 group.AddTransition(clip2.Offset - halfDuration, halfDuration, \cf10 StandardTransitions\cf0 .CreateFade(), \cf2 true\cf0 );\par ??                group.AddTransition(clip2.Offset, halfDuration, \cf10 StandardTransitions\cf0 .CreateFade(), \cf2 false\cf0 );\par ??\par ??                \cf11 // again\par ??\cf0                 group.AddTransition(clip3.Offset - halfDuration, halfDuration, \cf10 StandardTransitions\cf0 .CreateFade(), \cf2 true\cf0 );\par ??                group.AddTransition(clip3.Offset, halfDuration, \cf10 StandardTransitions\cf0 .CreateFade(), \cf2 false\cf0 );\par ??\par ??                \cf11 // and again\par ??\cf0                 group.AddTransition(clip4.Offset - halfDuration, halfDuration, \cf10 StandardTransitions\cf0 .CreateFade(), \cf2 true\cf0 );\par ??                group.AddTransition(clip4.Offset, halfDuration, \cf10 StandardTransitions\cf0 .CreateFade(), \cf2 false\cf0 );\par ??\par ??                \cf11 // add some audio\par ??\cf0                 \cf10 ITrack\cf0  audioTrack = timeline.AddAudioGroup().AddTrack();\par ??                \par ??                \cf10 IClip\cf0  audio =\par ??                    audioTrack.AddAudio(\cf13 "testinput.wav"\cf0 , 0, videoTrack.Duration);\par ??\par ??                \cf11 // create an audio envelope effect, this will:\par ??\cf0                 \cf11 // fade the audio from 0% to 100% in 1 second.\par ??\cf0                 \cf11 // play at full volume until 1 second before the end of the track\par ??\cf0                 \cf11 // fade back out to 0% volume\par ??\cf0                 audioTrack.AddEffect(0, audio.Duration,\par ??                                     \cf10 StandardEffects\cf0 .CreateAudioEnvelope(1.0, 1.0, 1.0, audio.Duration));\par ??\par ??                \cf11 // render our slideshow out to a windows media file\par ??\cf0                 \cf2 using\cf0  (\par ??                    \cf10 IRenderer\cf0  renderer =\par ??                        \cf2 new\cf0  \cf10 WindowsMediaRenderer\cf0 (timeline, outputFile, \cf10 WindowsMediaProfiles\cf0 .HighQualityVideo))\par ??                \{\par ??                    renderer.Render();\par ??                \}\par ??            \}\par ??        \}}
-->
<div style="font-family: Courier; font-size: 10pt; color: black; background: white;">
<p style="margin: 0px;">&nbsp;&nbsp; <span style="color: green;">// generates a little slide-show, with audio track and fades between images.</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;">&nbsp;&nbsp; <span style="color: blue;">string</span> outputFile = <span style="color: maroon;">"FadeBetweenImages.wmv"</span>;</p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;">&nbsp;&nbsp; <span style="color: blue;">using</span> (<span style="color: teal;">ITimeline</span> timeline = <span style="color: blue;">new</span> <span style="color: teal;">DefaultTimeline</span>())</p>
<p style="margin: 0px;">&nbsp;&nbsp; {</p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: teal;">IGroup</span> group = timeline.AddVideoGroup(32, 160, 100);</p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: teal;">ITrack</span> videoTrack = group.AddTrack();</p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: teal;">IClip</span> clip1 = videoTrack.AddImage(<span style="color: maroon;">"image1.jpg"</span>, 0, 2); <span style="color: green;">// play first image for a little while</span></p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: teal;">IClip</span> clip2 = videoTrack.AddImage(<span style="color: maroon;">"image2.jpg"</span>, 0, 2); <span style="color: green;">// and the next</span></p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: teal;">IClip</span> clip3 = videoTrack.AddImage(<span style="color: maroon;">"image3.jpg"</span>, 0, 2); <span style="color: green;">// and finally the last</span></p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: teal;">IClip</span> clip4 = videoTrack.AddImage(<span style="color: maroon;">"image4.jpg"</span>, 0, 2); <span style="color: green;">// and finally the last</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: blue;">double</span> halfDuration = 0.5;</p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: green;">// fade out and back in</span></p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; group.AddTransition(clip2.Offset - halfDuration, halfDuration, <span style="color: teal;">StandardTransitions</span>.CreateFade(), <span style="color: blue;">true</span>);</p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; group.AddTransition(clip2.Offset, halfDuration, <span style="color: teal;">StandardTransitions</span>.CreateFade(), <span style="color: blue;">false</span>);</p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: green;">// again</span></p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; group.AddTransition(clip3.Offset - halfDuration, halfDuration, <span style="color: teal;">StandardTransitions</span>.CreateFade(), <span style="color: blue;">true</span>);</p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; group.AddTransition(clip3.Offset, halfDuration, <span style="color: teal;">StandardTransitions</span>.CreateFade(), <span style="color: blue;">false</span>);</p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: green;">// and again</span></p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; group.AddTransition(clip4.Offset - halfDuration, halfDuration, <span style="color: teal;">StandardTransitions</span>.CreateFade(), <span style="color: blue;">true</span>);</p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; group.AddTransition(clip4.Offset, halfDuration, <span style="color: teal;">StandardTransitions</span>.CreateFade(), <span style="color: blue;">false</span>);</p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: green;">// add some audio</span></p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: teal;">ITrack</span> audioTrack = timeline.AddAudioGroup().AddTrack();</p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: teal;">IClip</span> audio =</p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; audioTrack.AddAudio(<span style="color: maroon;">"testinput.wav"</span>, 0, videoTrack.Duration);</p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: green;">// create an audio envelope effect, this will:</span></p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: green;">// fade the audio from 0% to 100% in 1 second.</span></p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: green;">// play at full volume until 1 second before the end of the track</span></p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: green;">// fade back out to 0% volume</span></p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; audioTrack.AddEffect(0, audio.Duration,</p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;  <span style="color: teal;">StandardEffects</span>.CreateAudioEnvelope(1.0, 1.0, 1.0, audio.Duration));</p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: green;">// render our slideshow out to a windows media file</span></p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: blue;">using</span> (</p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; <span style="color: teal;">IRenderer</span> renderer =</p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; <span style="color: blue;">new</span> <span style="color: teal;">WindowsMediaRenderer</span>(timeline, outputFile, <span style="color: teal;">WindowsMediaProfiles</span>.HighQualityVideo))</p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; {</p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; renderer.Render();</p>
<p style="margin: 0px;">&nbsp;&nbsp; &nbsp;&nbsp; }</p>
<p style="margin: 0px;">&nbsp;&nbsp; }</p>
</div>

</body>
</html>